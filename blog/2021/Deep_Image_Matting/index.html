<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Deep Image Matting | Samuel Pietri</title> <meta name="author" content="Samuel Pietri"/> <meta name="description" content="Personal Website "/> <meta name="keywords" content="machine learning, deep learning, generative art, creative coding, creative technologist, technical artist"/> <meta property="og:site_name" content="Samuel Pietri"/> <meta property="og:type" content="website"/> <meta property="og:title" content="Samuel Pietri | Deep Image Matting"/> <meta property="og:url" content="https://samuelpietri.github.io/blog/2021/Deep_Image_Matting/"/> <meta property="og:description" content="Personal Website "/> <meta property="og:locale" content="en"/> <meta name="twitter:card" content="summary"/> <meta name="twitter:title" content="Deep Image Matting"/> <meta name="twitter:description" content="Personal Website "/> <meta name="twitter:site" content="@samuelpietri"/> <meta name="twitter:creator" content="@samuelpietri"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/favicon.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://samuelpietri.github.io/blog/2021/Deep_Image_Matting/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body class="fixed-top-navsticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Samuel </span>Pietri</a> <div class="navbar-brand social"> <a href="mailto:%70%69%65%74%72%69.%73%61%6D%75%65%6C@%67%6D%61%69%6C.%63%6F%6D" title="email"><i class="fas fa-envelope"></i></a> <a href="https://github.com/samuelpietri" title="GitHub" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i></a> <a href="https://www.linkedin.com/in/samuel-pietri" title="LinkedIn" target="_blank" rel="noopener noreferrer"><i class="fab fa-linkedin"></i></a> <a href="https://twitter.com/samuelpietri" title="Twitter" target="_blank" rel="noopener noreferrer"><i class="fab fa-twitter"></i></a> <a href="https://instagram.com/samuelpietri" title="Instagram" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram"></i></a> </div> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/projects/">PROJECTS</a> </li> <li class="nav-item "> <a class="nav-link" href="/">ABOUT</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>Deep Image Matting</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#modnet-results">MODnet Results</a></div> <div><a href="#u-2-net-results">U-2-Net Results</a></div> </nav> </d-contents> <p><br></p> <p>The greenscreen will become obsolete, that’s a fact. One way or another new techniques will jump in and will make work of image-matting a much more automated, less time-consuming job. To be fair some alternatives are already been used in Hollywood productions such as the <a href="https://www.insider.com/green-screen-virtual-sets-mandalorian-2020-4" target="_blank" rel="noopener noreferrer">virtual sets</a> used in the latest Disney series <em>The Mandalorian</em>. A set of led screens recreate the environment in real time improving the effects of reflections and allowing the actors to move in a much more realistic set are becoming a thing.</p> <p>Deep learning techniques are emerging as well, letting the practice of manually cutting out content over background becoming fully automated, with almost no supervision. Now I’ll take a look at a couple of different projects I found.</p> <ul> <li> <strong><a href="https://github.com/ZHKKKe/MODNet" target="_blank" rel="noopener noreferrer">MODNet</a> -</strong> <em>Is a Green Screen Really Necessary for Real-Time Portrait Matting?</em> </li> <li> <strong><a href="https://github.com/NathanUA/U-2-Net" target="_blank" rel="noopener noreferrer">U-2-Net</a></strong> <em>- Going Deeper with Nested U-Structure for Salient Object Detection</em> </li> </ul> <p>Although they have fairly different architectures they do share the common great advantage to be very easy to test and flexible enough to be tested quickly on different content. <em>U-2-Net</em> has shown already very interesting application capabilites. Just look at the <a href="https://github.com/cyrildiagne/ar-cutpaste" target="_blank" rel="noopener noreferrer">AR Copy Paste</a> project from Cyril Diagne which is just scratching the surface of how these new tools will gradually change the content creation field.</p> <p>The possible applications of this technique are fairly straightforward and apart from background matting for movies, we see a vast usage of similar tools in our daily life for any video conferencing system at our disposal. Who doesn’t want some custom, weirdly-looking background these days? To be fair there are other promising projects such as <a href="https://github.com/PeterL1n/BackgroundMattingV2" target="_blank" rel="noopener noreferrer">Real-Time High-Resolution Background Matting</a> which can give very similar or even better results but most of them are trickier to work with, require auxiliary inputs or they’re simply computationally intensive.</p> <p>Since I’ve already introduced <em>The Mandalorian</em> I’ll use some shots from the series to test both frameworks. I’ll start with these scene, with one or multiple character and different lighting conditions.</p> <p><br></p> <h2 id="modnet-results">MODNet results</h2> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/MODNet_001.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/MODNet_002.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/MODNet_003.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="u-2-net-results">U-2-Net results</h2> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/U-2-Net_001.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/U-2-Net_002.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/U-2-Net_003.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br> I believe they’re doing a decent job extracting the foreground characters from the environment but anyone who has tried cutting out figures in Photoshop knows that the real issue arise when your working on the edges of the character. Any little detail, the hair or even accessories can be troublesome and greatly affect the ability to perform the task well. The <em>MODNet</em> model seems to handle very well a wider range of scenarios and is able to extract details in more refined way, expecially on the boundary of the extracted shape. The <em>U-2-Net</em> is still very good but less precise on the border and the objects direcly related to the character.</p> <p>It becomes clear that having really detailed masks such the one produced by the <em>MODNet</em> model, can be used right away letting you change the background in a metter of seconds such in this small sample I provide here below.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/Image_Matting_Test.gif" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Let’s move to video content. Here I selected scenes with clear characters in front of the camera.</p> <iframe src="https://player.vimeo.com/video/496647965" width="100%" height="450" frameborder="0" allow="autoplay; fullscreen" allowfullscreen=""></iframe> <p>And surpsingly both models are doing just fine. The time consistency is still the main issue though, with some clear unwanted flickering effect appearing on the alpha mask especially with fast movement on screen.</p> <p>After some test it becomes clear that <em>MODNet</em> sometimes show these large stains, which are difficult to intepret since they seems to appear with different contents in the input image. <br></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/MODnet_Errors.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><em>MODnet_Errors</em> <br></p> <p><em>U-2-Net</em> on the other hand is not showing any weird shapes in the alpha mask but at the same time is less precise finding the actual contour of the characters and it definitely struggles handling reflections, such us the one on the armour. <br></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/U-2-Net_Errors.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><em>U-2-Net_Errors</em> <br></p> <p>Here some more side by side comparison between the two models. Again they both have their flaws but in the context of portrait matting I believe <em>MODNet</em> is doing a better job. <br></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/MODNet_U-2-Net_001.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/MODNet_U-2-Net_002.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/posts/image_matting/MODNet_U-2-Net_003.jpg" class="img-fluid rounded" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <p>And if you haven’t had enough here’s a longer footage where a much diverse of images are processed. The more we have</p> <iframe src="https://player.vimeo.com/video/496656226" width="800" height="450" frameborder="0" allow="autoplay; fullscreen" allowfullscreen=""></iframe> <p><br></p> <p>Next up some I’ll do some more testing of these models in the wild.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2025 Samuel Pietri. </div> </footer> <d-bibliography src="/assets/bibliography/"></d-bibliography> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>